var WebBarcodeScannerPreloader,WebBarcodeScannerAdminMenuList,WebBarcodeScannerShortcut,WebBarcodeScannerOpen,WebBarcodeScannerClose,WebBarcodeScannerDisableEvents,WebBarcodeScannerWpMedia;!window.usbs&&window.usbsMobile&&(window.usbs=window.usbsMobile),WebBarcodeScannerPreloader=function(a){if(jQuery("#barcode-scanner-preloader").remove(),a){let a='#barcode-scanner-preloader { position: fixed;top: 0px;left: 0px;width: 100vw;height: 100vh;z-index: 9000;font-size: 14px;background: rgba(0, 0, 0, 0.3);transition: opacity 0.3s ease 0s;transform: translate3d(0px, 0px, 0px); }';a+='#barcode-scanner-preloader .a4b-preloader-icon {position: relative;top: 50%;left: 50%;color: #fff;border-radius: 50%;opacity: 1;width: 30px;height: 30px;border: 2px solid #f3f3f3;border-top: 3px solid #3498db;display: inline-block;animation: a4b-spin 1s linear infinite; }',a+='@keyframes a4b-spin { 100% { -webkit-transform: rotate(360deg); transform:rotate(360deg); } }';let b=jQuery('<div id="barcode-scanner-preloader"><span class="a4b-preloader-icon"></span></div>');jQuery("#wpbody-content").append('<style>'+a+'</style>'),jQuery("#wpbody-content").append(b)}},WebBarcodeScannerAdminMenuList=function(){try{let a=window.usbs.wp_version,b=window.usbs.settings&&window.usbs.settings.license?window.usbs.settings.license.key:"";jQuery("#adminmenu span.barcode_scanner_faq").closest("a").attr("target","_blank").attr("href","https://www.ukrsolution.com/ExtensionsSupport/Support?extension=25&version=1.5.1&pversion="),jQuery("#adminmenu span.barcode_scanner_faq").closest("a").attr("target","_blank").attr("href","https://www.ukrsolution.com/Wordpress/WooCommerce-Barcode-QRCode-Scanner-Reader#faq"),jQuery("#adminmenu span.barcode_scanner_support").closest("a").attr("target","_blank").attr("href","https://www.ukrsolution.com/ExtensionsSupport/Support?extension=24&version=1.5.1&pversion="+a+"&d="+btoa(b))}catch(a){console.error(a.message)}},WebBarcodeScannerShortcut=function(){try{document.addEventListener("keydown",function(a){if(a.altKey&&(a.key=="b"||a.code=="KeyB")){const a=jQuery(".ukrsolution-barcode-scanner-frame");if(!a||!a.length||a&&a.hasClass("closed")){const a=jQuery('a[href="admin.php?page=barcode-scanner"]');a&&a.click()}else WebBarcodeScannerClose()}})}catch(a){console.error(a.message)}},WebBarcodeScannerOpen=function(c){let a;a=window.frames.ukrsolutionBarcodeScannerFrame;const b=c.target.getAttribute("href");let d=["#barcode-scanner-settings"];if(a){a.postMessage(JSON.stringify({message:"element-click",href:b}),"*");const c=document.querySelector("iframe.ukrsolution-barcode-scanner-frame");c&&!d.includes(b)&&c.classList.remove("closed");const e=document.querySelector("body");e.classList.add("barcode-scanner-shows")}},WebBarcodeScannerClose=function(){const a=document.querySelector("iframe.ukrsolution-barcode-scanner-frame");a&&a.classList.add("closed");const b=document.querySelector("body");b.classList.remove("barcode-scanner-shows")},WebBarcodeScannerDisableEvents=function(){const a=function(a){if(a.keyCode==13)return a.preventDefault(),!1},b=function(a){if(a.keyCode==13){const b=""+jQuery(a.target).attr("name");if(b.search("variable_sku")>=0||b.search("variable_alg_ean")>=0||b.search("_wpm_gtin_code_variable")>=0||b.search("variation_barcode")>=0||b.search("usbs_barcode_field_v")>=0||b.search("variation_supplier_sku")>=0||b.search("hwp_var_gtin")>=0||b.search("variable_gtin")>=0||b.search("variable_mpn")>=0||b.search("ean_generator_code")>=0)return a.preventDefault(),!1}};jQuery('body').on("keydown",'.usbs_barcode_field_text',a),jQuery('body').on("keydown",'#woocommerce-product-data input[name="_alg_ean"]',a),jQuery('body').on("keydown",'#woocommerce-product-data input[name="_supplier_sku"]',a),jQuery('body').on("keydown",'#woocommerce-product-data input[name="_barcode"]',a),jQuery('body').on("keydown",'#inventory_product_data input[name="_sku"]',a),jQuery('body').on("keydown",'#inventory_product_data input[name="_wpm_gtin_code"]',a),jQuery('body').on("keydown",'#inventory_product_data input[name="hwp_product_gtin"]',a),jQuery('body').on("keydown",'#inventory_product_data input[name="_ean_generator_code"]',a),jQuery('body').on("keydown",'#general_product_data input[name="_wepos_barcode"]',a),jQuery('body').on("keydown",'#general_product_data input[name="_ts_gtin"]',a),jQuery('body').on("keydown",'#general_product_data input[name="_gtin"]',a),jQuery('body').on("keydown",'#general_product_data input[name="_ts_mpn"]',a),jQuery('body').on("keydown",'#general_product_data input[name="_mpn"]',a),jQuery('body').on("keydown",'.woocommerce_variation input[type="text"]',b)},WebBarcodeScannerWpMedia=function(b){var a;if(a){a.open();return}a=wp.media({title:"Select or Upload Media Of Your Chosen Persuasion",button:{text:"Use this media"},multiple:!1}),a.on("select",function(){try{var c=a.state().get("selection").first().toJSON();let d;d=window.frames.ukrsolutionBarcodeScannerFrame,d.postMessage(JSON.stringify({message:"wp-media-attachment",attachment:c,postId:b}),"*")}catch(a){console.error(a)}}),a.open()},jQuery(document).ready(function(){WebBarcodeScannerAdminMenuList(),WebBarcodeScannerShortcut(),window.addEventListener("mousedown",function(b){const a=jQuery(b.target).attr("href");document.body.classList.contains("barcode-scanner-shows")&&a&&(location.href=a)},!1);let c='a[href="admin.php?page=barcode-scanner"], a[href="#barcode-scanner-settings"], a[href*="barcode-scanner-admin-bar"], a[href*="barcode-scanner-frontend"], a[href*="#barcode-scanner-products-indexation"], a[href*="#barcode-scanner-search-filter"], [href="#usbs-locations-print"]',a=jQuery(c),d=function(k){var f,g,b,i,j;k.preventDefault(),k.stopPropagation(),a.off("click"),a.click(function(a){a.preventDefault(),a.stopPropagation(),jQuery(a.target).attr("href")!=="#barcode-scanner-settings"&&WebBarcodeScannerOpen(a)}),WebBarcodeScannerPreloader(!0);let d='.ukrsolution-barcode-scanner-frame{ position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 1290; }';d+='.ukrsolution-barcode-scanner-frame.closed{ display: none; }',d+='body.barcode-scanner-shows{ overflow: hidden; }';const e=document.createElement("style");e.styleSheet?e.styleSheet.cssText=d:e.appendChild(document.createTextNode(d)),document.body.appendChild(e);let m='<style data-name="usbsCustomCss">';m+=window.usbsCustomCss?window.usbsCustomCss.css:"",m+='</style>',f=localStorage.getItem("barcode-scanner-v1"),f||(f="{}"),g=document.createElement("script"),g.type="text/javascript",g.text="var serializedData = '"+f+"';",window.addEventListener("message",function(a){switch(a.data.message){case"localStorage.setItem":localStorage.setItem(a.data.storageKey,a.data.serializedData);break;case"iframe.onload":WebBarcodeScannerPreloader(!1),jQuery(k.target).click();break;case"iframe.close":WebBarcodeScannerClose();break;case"iframe.wpMedia":WebBarcodeScannerWpMedia(a.data.postId);break;case"iframe.importLabels":if(a.data.products){const e=a.data.types&&a.data.types.length&&a.data.types[0]==="product_variation"?"variation":"simple";jQuery('.usbs-label-import').remove();const c=jQuery('<span class="usbs-label-import" style="overflow: hidden; width: 0; height: 0;"></span>');let b='<button type="button" class="barcodes-external-import" ';b+='onclick="window.barcodesImportIdsType=\''+e+"'; ",b+='window.barcodesImportIds=['+a.data.products+']; ',b+="window.usplOpenedFrom='scanner'; ",b+='"></button>';const d=jQuery(b);c.append(d),jQuery('body').append(c),d.click(),WebBarcodeScannerClose()}else console.warn("Incorrect data",a.data);break;case"iframe.openScanner":const b=jQuery('a[href="admin.php?page=barcode-scanner"]');b&&b.click();break}},!1);const c=document.createElement("iframe");c.className="ukrsolution-barcode-scanner-frame closed",c.name="ukrsolutionBarcodeScannerFrame",document.body.appendChild(c);let l='<link rel="preconnect" href="https://fonts.googleapis.com">';l='<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>',l='<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">';let h='<style>';return h+='.not-number input::-webkit-outer-spin-button, .not-number input::-webkit-inner-spin-button { -webkit-appearance: none !important; margin: 0; }',h+='.not-number input[type=number] { -moz-appearance: textfield !important; }',h+='</style>',b=c.contentDocument||c.contentWindow.document,b.open(),b.write(h+l+m+'<div id="ukrsolution-barcode-scanner"></div>'+'<div id="ukrsolution-barcode-scanner-modal"></div>'+'<div id="ukrsolution-barcode-scanner-settings"></div>'),b.body.appendChild(g),i=document.createElement("script"),i.type="text/javascript",i.src=window.usbs.appJsPath,b.body.appendChild(i),j=document.createElement("script"),j.type="text/javascript",j.src=window.usbs.vendorJsPath,b.body.appendChild(j),b.close(),!1};if(a.off("click"),a.click(d),window.BarcodeScannerAutoShow)try{document.getElementById("barcode-scanner-auto-show").click()}catch(a){console.warn("element #barcode-scanner-auto-show not found",a.message)}WebBarcodeScannerDisableEvents();const b=document.querySelector('a.usbs-auto-start-modal');b&&b.click()});const link=document.querySelector('a[href="admin.php?page=barcode-scanner"]');link&&(link.onclick=function(a){a.preventDefault()})