"use strict";!function(l){var u={admin:wc_pos_params,metaBoxes:wc_pos_admin_meta_boxes_params},f={states:null,init:function(){var t=this,e=(void 0!==u.metaBoxes.countries&&(this.states=l.parseJSON(u.metaBoxes.countries.replace(/&quot;/g,'"'))),l(".js_field-country").selectWoo().change(this.change_country),l(".js_field-country").trigger("change",[!0]),l(document.body).on("change","select.js_field-state",this.change_state).on("change","\n\t\t\t\t\t.wc_pos_input_email[type=text],\n\t\t\t\t\t.wc_pos_input_phone[type=text],\n\t\t\t\t\t.wc_pos_input_fax[type=text],\n\t\t\t\t\t.wc_pos_input_url[type=text]",this.validate).on("wc_pos_add_error_tip",this.addErrorTip).on("wc_pos_remove_error_tip",this.removeErrorTip).on("click","#use-store-address",this.useStoreAddress),l("#wc_pos_managed_outlets").selectWoo().on("change",this.renderOutletStockFields),document.querySelector(".woocommerce_variations"));e&&new MutationObserver(function(){l(".wc_pos_variation_managed_outlets").selectWoo().off("change",t.renderVariationOutletStockFields),l(".wc_pos_variation_managed_outlets").selectWoo().on("change",t.renderVariationOutletStockFields)}).observe(e,{childList:!0})},renderOutletStockFields:function(){var t=l(this).selectWoo("data"),a={};l("#wc_pos_outlet_stock_container").children(".form-field").each(function(){var t=l(this).find("input"),e=t.data("outlet-id"),t=t.val();a[e]=t}),l("#wc_pos_outlet_stock_container").empty(),t.sort(function(t,e){return e.id-t.id}).forEach(function(t){var e="wc_pos_outlet_stock_".concat(t.id),o=a[t.id]||0,t='\n<p class="form-field">\n\t<label for="'.concat(e,'">Stock for ').concat(t.text,'</label>\n\t<input type="number" step="any" data-outlet-id="').concat(t.id,'" value="').concat(o,'" id="').concat(e,'" name="').concat(e,'" />\n</p>');l("#wc_pos_outlet_stock_container").append(t)})},renderVariationOutletStockFields:function(){var t=l(this),e=t.selectWoo("data"),i=t.data("variation-index"),r={},s=(l("#wc_pos_variation_outlet_stock_container_".concat(i)).children(".form-field").each(function(){var t=l(this).find("input"),e=t.data("outlet-id"),t=t.val();r[e]=t}),l("#wc_pos_variation_outlet_stock_container_".concat(i)).empty(),0);e.sort(function(t,e){return e.id-t.id}).forEach(function(t){var e="wc_pos_variation_outlet_stock_".concat(t.id,"_").concat(i),o="wc_pos_variation_outlet_stock_".concat(t.id,"[").concat(i,"]"),a=r[t.id]||0,n=s%2==0?"form-row-first":"form-row-last",n='\n<p class="form-row '.concat(n,'">\n\t<label for="').concat(o,'">Stock for ').concat(t.text,'</label>\n\t<input type="number" step="any" data-outlet-id="').concat(t.id,'" value="').concat(a,'" id="').concat(e,'" name="').concat(o,'" />\n</p>');l("#wc_pos_variation_outlet_stock_container_".concat(i)).append(n),s++})},change_country:function(t,e){var o,a,n,i,r,s,c,_,d,p;void 0===e&&(e=!1),null!==f.states&&(a=(o=l(this)).val(),i=(n=o.parents(".postbox").find(":input.js_field-state")).parent(),r=n.attr("name"),s=n.attr("id"),c=o.data(c="woocommerce.stickState-"+a)?o.data(c):n.val(),_=n.attr("placeholder"),e&&o.data("woocommerce.stickState-"+a,c),i.show().find(".select2-container").remove(),l.isEmptyObject(f.states[a])?(p=l('<input type="text" />').prop("id",s).prop("name",r).prop("placeholder",_).addClass("js_field-state regular-text").val(c),n.replaceWith(p)):(d=f.states[a],e=l('<option value=""></option>').text(u.metaBoxes.i18n_select_state_text),p=l('<select style="width:50%;"></select>').prop("id",s).prop("name",r).prop("placeholder",_).addClass("js_field-state").append(e),l.each(d,function(t){t=l("<option></option>").prop("value",t).text(d[t]);p.append(t)}),p.val(c),n.replaceWith(p),p.show().selectWoo().hide().change()),l(document.body).trigger("country-change.woocommerce",[a,l(this).closest("div")]))},change_state:function(){var t=l(this),e=t.val(),t=t.parents(".postbox").find(":input.js_field-country"),o=t.val();t.data("woocommerce.stickState-"+o,e)},validate:function(){var t,e=l(this).val();l(this).is(".wc_pos_input_email")&&!/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)&&(t="i18n_email_error"),!l(this).is(".wc_pos_input_phone")&&!l(this).is(".wc_pos_input_fax")||/^[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\s\./0-9]*$/g.test(e)||(t=l(this).is(".wc_pos_input_fax")?"i18n_fax_error":"i18n_phone_error"),void 0!==(t=!l(this).is(".wc_pos_input_url")||/^(http[s]?:\/\/){0,1}(www\.){0,1}[a-zA-Z0-9\.\-]+\.[a-zA-Z]{2,5}[\.]{0,1}/.test(e)?t:"i18n_url_error")?(l(document.body).triggerHandler("wc_pos_add_error_tip",[l(this),t]),l(this).val("")):l(document.body).triggerHandler("wc_pos_remove_error_tip",[l(this),t])},addErrorTip:function(t,e,o){var a=e.position();0===e.parent().find(".wc_error_tip").length&&(e.after('<div class="wc_error_tip '+o+'">'+u.metaBoxes[o]+"</div>"),e.parent().find(".wc_error_tip").css("left",a.left+e.width()-e.width()/2-l(".wc_error_tip").width()/2).css("top",a.top+e.height()).fadeIn("100"))},removeErrorTip:function(t,e,o){e.parent().find(".wc_error_tip."+o).fadeOut("100",function(){l(this).remove()})},useStoreAddress:function(){var t;return window.confirm(u.metaBoxes.i18n_confirm_use_store_address)&&((t=l("form#post")).find('[name="address_1"]').val(u.metaBoxes.base_address_1),t.find('[name="address_2"]').val(u.metaBoxes.base_address_2),t.find('[name="city"]').val(u.metaBoxes.base_city),t.find('[name="postcode"]').val(u.metaBoxes.base_postcode),t.find('[name="country"]').val(u.metaBoxes.base_country).trigger("change"),t.find('[name="state"]').val(u.metaBoxes.base_state).trigger("change")),!1}};f.init()}(jQuery);